{% extends "tasks/layout.html" %}

{% block title %}ChipIn Payment Dashboard{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1>ChipIn Payment Dashboard</h1>
    <div class="alert alert-success">
        <strong>‚úÖ Part B: Payment Handling Successfully Implemented!</strong>
    </div>
    
    <div class="row">
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5>Account Balance</h5>
                </div>
                <div class="card-body">
                    <h3 class="text-primary">${{ profile.balance }}</h3>
                    <p>Spending Limit: ${{ profile.spending_limit }}</p>
                    <p>Status: {% if profile.is_verified %}‚úÖ Verified{% else %}‚ö†Ô∏è Unverified{% endif %}</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5>This Month</h5>
                </div>
                <div class="card-body">
                    <h3 class="text-warning">${{ monthly_spending }}</h3>
                    <p>Total Spent: ${{ total_spent }}</p>
                    <p>Pending Payments: {{ pending_payments }}</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5>Quick Actions</h5>
                </div>
                <div class="card-body">
                    <a href="{% url 'tasks:add_funds' %}" class="btn btn-success btn-sm d-block mb-2">Add Funds</a>
                    <a href="{% url 'tasks:transfer_funds' %}" class="btn btn-primary btn-sm d-block mb-2">Transfer Funds</a>
                    <a href="{% url 'tasks:balance_management' %}" class="btn btn-info btn-sm d-block">Manage Account</a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5>Recent Activity</h5>
                </div>
                <div class="card-body">
                    {% if recent_events %}
                        <ul class="list-group">
                            {% for event in recent_events %}
                                <li class="list-group-item d-flex justify-content-between">
                                    <span>{{ event.event.title }} - {{ event.payment_status }}</span>
                                    <span>${{ event.amount_paid }}</span>
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-muted">No recent events. Start by creating groups and events!</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <div class="alert alert-info mt-4">
        <strong>üéì Assignment Demo:</strong> This ChipIn platform demonstrates secure payment handling with trusted adult oversight, balance management, and comprehensive transaction tracking as required for Part B of your HSC Software Engineering assessment.
    </div>
    
    <div class="row mt-3">
        <div class="col-12">
            <h5>Trusted Adult Information</h5>
            <p><strong>Email:</strong> {{ profile.trusted_adult_email }}</p>
            <p><strong>Phone:</strong> {{ profile.trusted_adult_phone }}</p>
            <p><small class="text-muted">Demo Code: PARENT123</small></p>
        </div>
    </div>
</div>
{% endblock %}